# PHP Application Template
# Copy this folder to /var/www/your-app-name and customize
#
# Usage:
#   1. Copy: sudo serverkit create-app php myapp
#   2. Put your PHP files in ./src/
#   3. Start: docker compose up -d
#   4. Add site: sudo serverkit add-site myapp.domain.com <PORT>

services:
  app:
    image: php:${PHP_VERSION:-8.2}-fpm
    container_name: ${APP_NAME:-php-app}
    restart: unless-stopped
    volumes:
      - ./src:/var/www/html
      - ./php.ini:/usr/local/etc/php/conf.d/custom.ini:ro
    environment:
      - PHP_MEMORY_LIMIT=${PHP_MEMORY_LIMIT:-256M}
    networks:
      - app-network

  nginx:
    image: nginx:alpine
    container_name: ${APP_NAME:-php-app}-nginx
    restart: unless-stopped
    ports:
      - "${PORT:-8100}:80"
    volumes:
      - ./src:/var/www/html:ro
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - app
    networks:
      - app-network

  # Optional: Database (uncomment if needed)
  # db:
  #   image: mysql:8.0
  #   container_name: ${APP_NAME:-php-app}-db
  #   restart: unless-stopped
  #   environment:
  #     MYSQL_ROOT_PASSWORD: ${DB_ROOT_PASSWORD:-secret}
  #     MYSQL_DATABASE: ${DB_NAME:-app}
  #     MYSQL_USER: ${DB_USER:-app}
  #     MYSQL_PASSWORD: ${DB_PASSWORD:-secret}
  #   volumes:
  #     - db-data:/var/lib/mysql
  #   networks:
  #     - app-network

networks:
  app-network:
    driver: bridge

# volumes:
#   db-data:
